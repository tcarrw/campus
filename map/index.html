<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>PLNT Earth · Campus Map</title>
<meta name="theme-color" content="#0b0d11">
<style>
:root{
  --bg:#0a0c10;
  --ink:#e9ecf5;
  --muted:#aeb6c9;
  --glass:rgba(255,255,255,.06);
  --glass-2:rgba(255,255,255,.1);
  --accent:#b7a7ff;        /* Mirror/Violet */
  --honey:#ffd782;         /* Sabrina */
  --voice:#d2f0ff;         /* Ariana */
  --bridge:#ff9bd5;        /* Doechii */
  --clarity:#9ff1d7;       /* Sigrid */
  --alter:#ffadc2;         /* Alter Fire */
  --earth:#b0d98b;         /* Greta */
  --rim:#dcd1ff;
  --ring:0 0 0 3px rgba(183,167,255,.45);
  --radius:18px;
  --shadow:0 10px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:
  radial-gradient(1200px 800px at 70% -10%,rgba(183,167,255,.10),transparent 60%),
  linear-gradient(180deg,#0a0c10,#0a0c10 60%,#07090d);
  color:var(--ink); font:500 16px/1.55 ui-sans-serif,system-ui,Segoe UI,Roboto,Apple Color Emoji;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
a{color:inherit;text-decoration:none}
button{cursor:pointer;border:0}
kbd{font:600 11px/1 ui-monospace, SFMono-Regular, Menlo, monospace;background:#141722;border:1px solid rgba(255,255,255,.15);padding:4px 6px;border-radius:6px;color:#bcd}

/* Header */
.header{
  display:flex;align-items:center;gap:14px;position:sticky;top:0;z-index:10;
  background:linear-gradient(180deg,rgba(10,12,16,.9),rgba(10,12,16,.65) 80%,transparent);
  backdrop-filter:saturate(140%) blur(10px);padding:14px 16px;border-radius:0 0 18px 18px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.logo{
  width:40px;height:40px;border-radius:12px;background:
  conic-gradient(from 210deg at 50% 50%,#b7a7ff,#ffd782,#9ff1d7,#ff9bd5,#d2f0ff,#ffadc2,#b0d98b,#b7a7ff);
  box-shadow:0 0 0 2px rgba(255,255,255,.08), inset 0 0 40px rgba(255,255,255,.25);
}
.hgroup{display:flex;flex-direction:column}
.h1{font-size:18px;letter-spacing:.6px}
.h2{font-size:12px;color:var(--muted)}

/* Layout */
.wrap{max-width:1100px;margin:0 auto;padding:18px 16px 48px}
.card{
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); box-shadow:var(--shadow);
}
.grid{display:grid;grid-template-columns:5fr 7fr;gap:14px;margin-top:16px}
@media (max-width:980px){ .grid{grid-template-columns:1fr} }

/* Controls */
.controls{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:12px}
.sel, .btn{
  width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);
  background:var(--glass);color:var(--ink);font-weight:700;letter-spacing:.3px
}
.btn.primary{background:var(--accent);color:#0a0c10;border-color:transparent}
.btn.ghost{background:var(--glass);color:var(--ink)}
.meta{color:var(--muted);font-size:12px;padding:0 12px 12px}
.inline{display:inline-flex;gap:8px;align-items:center}

/* School list */
.school-list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:12px}
.school{
  display:flex;gap:10px;align-items:center;padding:12px;border-radius:14px;background:var(--glass);
  border:1px solid rgba(255,255,255,.08)
}
.school .dot{width:14px;height:14px;border-radius:6px}
.school small{color:var(--muted);display:block;margin-top:2px}

/* Room grid */
.roomwrap{padding:12px}
.roomgrid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:10px}
.roombtn{
  font-size:12px;line-height:1;padding:10px 0;border-radius:9px;background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.08)
}
.roombtn[aria-current="true"]{outline:var(--ring);background:rgba(183,167,255,.12)}
.summary{padding:12px;border-top:1px dashed rgba(255,255,255,.12);display:grid;gap:8px}
.badge{
  display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;background:var(--glass)
}
.badge .b{width:20px;height:20px;border-radius:8px;box-shadow:inset 0 0 0 2px rgba(0,0,0,.25),0 0 16px rgba(255,255,255,.15)}
.copy{display:flex;gap:8px;flex-wrap:wrap}

/* Alive layer */
.alive{
  pointer-events:none;position:fixed;inset:0;background:
  radial-gradient(900px 500px at 20% -10%,rgba(255,255,255,.05),transparent 60%),
  radial-gradient(900px 500px at 80% 110%,rgba(255,255,255,.04),transparent 60%);
  mask-image:radial-gradient(100% 60% at 50% 30%,rgba(0,0,0,.9),transparent);
  animation:drift 22s linear infinite;
}
@keyframes drift{0%{transform:translateY(0)}50%{transform:translateY(6px)}100%{transform:translateY(0)}}
.footer{margin-top:20px;padding:14px;text-align:center;color:var(--muted);font-size:12px}
</style>
</head>
<body>
<div class="alive"></div>
<div class="header">
  <div class="logo" aria-hidden="true"></div>
  <div class="hgroup">
    <div class="h1">PLNT Earth · Campus Map</div>
    <div class="h2">Hash router: <span id="hashView">#school=mirror&room=1</span></div>
  </div>
</div>

<div class="wrap">
  <section class="grid">
    <!-- LEFT: picker -->
    <aside class="card">
      <div class="controls">
        <select id="schoolSel" class="sel" aria-label="Choose school"></select>
        <select id="roomSel" class="sel" aria-label="Choose room"></select>
        <button id="todayBtn" class="btn">Today</button>
        <button id="randomBtn" class="btn ghost">Random</button>
      </div>
      <div class="meta">Tip: <span class="inline"><kbd>T</kbd> today</span> · <span class="inline"><kbd>R</kbd> random</span> · <span class="inline"><kbd>↵</kbd> open</span></div>

      <div class="school-list" id="schoolList"></div>
      <div class="roomwrap">
        <div class="roomgrid" id="roomGrid" aria-label="Rooms 1–42"></div>
      </div>
    </aside>

    <!-- RIGHT: summary + open -->
    <article class="card" id="summary">
      <div class="summary">
        <div class="badge"><div class="b" id="schoolColor" style="background:var(--accent)"></div><b id="schoolName">Mirror School</b></div>
        <div class="meta" id="cycleLine">Cycle: —</div>
        <div class="meta" id="statusLine">Selected: Mirror · Room 1</div>
        <div class="copy">
          <button id="openBtn" class="btn primary">Open This Room</button>
          <button id="copyBtn" class="btn ghost">Copy Deep Link</button>
          <button id="homeBtn" class="btn ghost">Open School Home</button>
        </div>
        <div class="meta" id="hintLine">If a school is “Coming Soon”, the Map opens instead and highlights the room.</div>
      </div>
    </article>
  </section>

  <div class="footer">Alive layer on · Coming Soon links auto-hide when domains go live.</div>
</div>

<script>
(function(){
  /* ---------- Config (same shape as index.html) ---------- */
  var campus = {
    schools: [
      { key:"honey",   name:"Honey School",    color:"var(--honey)",  domain:"honey.plnt.earth",   live:false,
        teaches:"magnetism, savor, playful confidence" },
      { key:"mirror",  name:"Mirror School",   color:"var(--accent)", domain:"mirrorhoney.plnt.earth", live:false,
        teaches:"self-witnessing, boundary, reinvention" },
      { key:"voice",   name:"Voice School",    color:"var(--voice)",  domain:"voice.plnt.earth",   live:false,
        teaches:"breath, placement, tenderness with power" },
      { key:"bridge",  name:"Bridge School",   color:"var(--bridge)", domain:"bridge.plnt.earth",  live:false,
        teaches:"disruption, humor, lane-switching" },
      { key:"clarity", name:"Clarity School",  color:"var(--clarity)",domain:"clarity.plnt.earth", live:false,
        teaches:"integrity, bright directness" },
      { key:"alter",   name:"Alter Fire (Elective)", color:"var(--alter)",domain:"alter.fire.plnt.earth", live:true,
        teaches:"stance, heat-to-craft" },
      { key:"earth",   name:"Earth Conscience", color:"var(--earth)", domain:"earth.plnt.earth",   live:false,
        teaches:"ethics, pacing, consequences" }
    ],
    corridors: ["Launch","New Year","Early Spring","Solstice Build","High Summer","Autumn Shift","Year-End Reflection"]
  };

  var cycles = [
    { name:"Illumina 1 — Launch", start:"2025-11-05", end:"2025-12-17" },
    { name:"Illumina 2 — New Year", start:"2026-01-03", end:"2026-02-14" },
    { name:"Illumina 3 — Early Spring", start:"2026-03-03", end:"2026-04-14" },
    { name:"Illumina 4 — Solstice Build", start:"2026-05-01", end:"2026-06-12" },
    { name:"Illumina 5 — High Summer", start:"2026-06-30", end:"2026-08-11" },
    { name:"Illumina 6 — Autumn Shift", start:"2026-08-29", end:"2026-10-10" },
    { name:"Illumina 7 — Year-End", start:"2026-10-28", end:"2026-12-09" }
  ];

  /* ---------- Utilities ---------- */
  function $(s,el){return (el||document).querySelector(s)}
  function $$(s,el){return Array.prototype.slice.call((el||document).querySelectorAll(s,el))}
  function parseDate(d){ var a=d.split("-"); return new Date(+a[0],+a[1]-1,+a[2]); }
  function clamp(v,min,max){ return v<min?min:(v>max?max:v); }

  function findCycleFor(date){
    for(var i=0;i<cycles.length;i++){
      var a=parseDate(cycles[i].start), b=parseDate(cycles[i].end);
      if(date>=a && date<=b) return cycles[i];
    }
    return null;
  }
  function dayOfCycle(date){
    var c=findCycleFor(date);
    if(!c) return { day:1, label:"Pre-cycle", cycle:null };
    var d=Math.floor((date - parseDate(c.start))/86400000)+1;
    return { day:clamp(d,1,42), label:c.name, cycle:c };
  }

  function getHashState(){
    var h=location.hash.replace(/^#/,"");
    var p=new URLSearchParams(h);
    var school=p.get("school")||"mirror";
    var room=Number(p.get("room")||dayOfCycle(new Date()).day);
    if(!campus.schools.find(function(s){return s.key===school})) school="mirror";
    room=clamp(Math.floor(room)||1,1,42);
    return {school:school, room:room};
  }
  function setHashState(state){
    var h=new URLSearchParams();
    h.set("school",state.school);
    h.set("room",String(state.room));
    var str="#"+h.toString();
    if(location.hash!==str){ location.hash=str; }
    $("#hashView").textContent = str;
  }

  /* ---------- Renderers ---------- */
  function renderSelectors(){
    var sel=$("#schoolSel"); sel.innerHTML="";
    campus.schools.forEach(function(s){
      var opt=document.createElement("option");
      opt.value=s.key; opt.textContent=s.name+(s.live?"":" · Coming Soon");
      sel.appendChild(opt);
    });
    var r=$("#roomSel"); r.innerHTML="";
    for(var i=1;i<=42;i++){
      var o=document.createElement("option"); o.value=String(i); o.textContent="Room "+i;
      r.appendChild(o);
    }
  }
  function renderSchoolList(active){
    var box=$("#schoolList"); box.innerHTML="";
    campus.schools.forEach(function(s){
      var a=document.createElement("a"); a.href="javascript:void(0)"; a.className="school";
      a.setAttribute("data-key",s.key);
      a.innerHTML='<div class="dot" style="background:'+s.color+'"></div><div><b>'+s.name+'</b><small>'+s.teaches+(s.live?"":" · Coming Soon")+'</small></div>';
      if(s.key===active){ a.style.outline="var(--ring)"; a.style.background="rgba(183,167,255,.08)"; }
      a.addEventListener("click", function(){ updateState({school:s.key}); });
      box.appendChild(a);
    });
  }
  function renderRooms(activeRoom){
    var grid=$("#roomGrid"); grid.innerHTML="";
    for(var i=1;i<=42;i++){
      var b=document.createElement("button"); b.className="roombtn"; b.textContent=i; b.setAttribute("data-room",i);
      if(i===activeRoom) b.setAttribute("aria-current","true");
      b.addEventListener("click", function(e){
        var n=Number(e.currentTarget.getAttribute("data-room"));
        updateState({room:n});
      });
      grid.appendChild(b);
    }
  }
  function renderSummary(state){
    var s=campus.schools.find(function(x){return x.key===state.school}) || campus.schools[1];
    $("#schoolName").textContent = s.name+(s.live?"":" · Coming Soon");
    $("#schoolColor").style.background = s.color;
    var today = dayOfCycle(new Date());
    $("#cycleLine").textContent = (today.label==="Pre-cycle" ? "Pre-cycle (Next: Illumina 1 — Nov 5, 2025)" : today.label);
    $("#statusLine").textContent = "Selected: "+s.name.split(" (")[0]+" · Room "+state.room;
  }

  /* ---------- Actions ---------- */
  function deepLink(state){
    var s=campus.schools.find(function(x){return x.key===state.school}) || campus.schools[1];
    var base = s.live ? ("https://"+s.domain) : (location.origin+location.pathname);
    var path = s.live ? ("/room/"+state.room) : ("#school="+s.key+"&room="+state.room);
    return base + path;
  }
  function openSelected(state){
    var s=campus.schools.find(function(x){return x.key===state.school}) || campus.schools[1];
    if(s.live){
      window.location.href = deepLink(state);
    }else{
      setHashState(state); // stay here and highlight
    }
  }

  /* ---------- State + Update ---------- */
  var state = getHashState();

  function updateState(patch){
    state = { school: patch.school || state.school, room: patch.room || state.room };
    setHashState(state);
    syncUI();
  }

  function syncUI(){
    $("#schoolSel").value = state.school;
    $("#roomSel").value = String(state.room);
    renderSchoolList(state.school);
    renderRooms(state.room);
    renderSummary(state);
  }

  /* ---------- Init ---------- */
  renderSelectors();
  syncUI();

  /* ---------- Events ---------- */
  $("#schoolSel").addEventListener("change", function(e){ updateState({school:e.target.value}); });
  $("#roomSel").addEventListener("change", function(e){ updateState({room:Number(e.target.value)}); });

  $("#todayBtn").addEventListener("click", function(){
    var t=dayOfCycle(new Date()).day; updateState({room:t});
  });
  $("#randomBtn").addEventListener("click", function(){
    updateState({room: Math.floor(Math.random()*42)+1 });
  });

  $("#openBtn").addEventListener("click", function(){ openSelected(state); });
  $("#homeBtn").addEventListener("click", function(){
    var s=campus.schools.find(function(x){return x.key===state.school});
    var url = s && s.live ? ("https://"+s.domain) : (location.origin+location.pathname+"#school="+state.school);
    window.location.href = url;
  });
  $("#copyBtn").addEventListener("click", function(){
    var url = deepLink(state);
    if(navigator.clipboard && navigator.clipboard.writeText){ navigator.clipboard.writeText(url); }
  });

  window.addEventListener("hashchange", function(){
    state = getHashState(); syncUI();
  });

  document.addEventListener("keydown", function(e){
    if(e.key==="t"||e.key==="T"){ var t=dayOfCycle(new Date()).day; updateState({room:t}); }
    if(e.key==="r"||e.key==="R"){ updateState({room: Math.floor(Math.random()*42)+1 }); }
    if(e.key==="Enter"){ openSelected(state); }
  }, {passive:true});
})();
</script>
</body>
</html>
